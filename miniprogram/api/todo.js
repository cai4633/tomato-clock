import { secureCheck } from './cloudfunc';
var AV = getApp().globalData.AV;
var getTodoList = function () {
    return new AV.Query('Todos').descending('createdAt')
        .find()
        .then(function (todos) {
        return todos.map(function (todo) { return todo.toJSON(); });
    })
        .catch(console.error);
};
var createTodoItem = function (description) {
    return secureCheck(description).then(function () {
        var todos = new AV.Object('Todos');
        todos.set('id', Math.random() * 100000 | 0);
        todos.set('completed', false);
        todos.set('description', description);
        return todos.save().then(function (res) {
            return res.toJSON();
        });
    });
};
var deleteTodoItem = function (id) {
    var todo = AV.Object.createWithoutData('Todos', id);
    todo.set('completed', true);
    return todo.save().then(function (res) { return res.toJSON(); });
};
var updateTodoItem = function (id, description) {
    return secureCheck(description).then(function () {
        var todo = AV.Object.createWithoutData('Todos', id);
        todo.set('description', description);
        return todo.save().then(function (res) { return res.toJSON(); });
    });
};
var createTomato = function () {
    var tomatoes = new AV.Object('Tomatoes');
    tomatoes.set('id', Math.random() * 100000 | 0);
    tomatoes.set('aborted', false);
    tomatoes.set('description', '');
    return tomatoes.save().then(function (res) { return res.toJSON(); });
};
var updateTomato = function (param) {
    var objectId = param.objectId, description = param.description, aborted = param.aborted;
    return secureCheck(description).then(function () {
        var tomato = AV.Object.createWithoutData('Tomatoes', objectId);
        tomato.set('description', description);
        tomato.set('aborted', aborted);
        return tomato.save().then(function (res) { return res.toJSON(); });
    });
};
export { getTodoList, createTodoItem, deleteTodoItem, updateTodoItem, createTomato, updateTomato };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidG9kby5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbInRvZG8udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0EsT0FBTyxFQUNMLFdBQVcsRUFDWixNQUFNLGFBQWEsQ0FBQTtBQUNaLElBQUEsMkJBQUUsQ0FBd0I7QUFDbEMsSUFBTSxXQUFXLEdBQUc7SUFDbEIsT0FBTyxJQUFJLEVBQUUsQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsVUFBVSxDQUFDLFdBQVcsQ0FBQztTQUNqRCxJQUFJLEVBQUU7U0FDTixJQUFJLENBQUMsVUFBQyxLQUFxQjtRQUMxQixPQUFPLEtBQUssQ0FBQyxHQUFHLENBQUMsVUFBQyxJQUFJLElBQUssT0FBQSxJQUFJLENBQUMsTUFBTSxFQUFFLEVBQWIsQ0FBYSxDQUFDLENBQUE7SUFDM0MsQ0FBQyxDQUFDO1NBQ0QsS0FBSyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQztBQUMxQixDQUFDLENBQUE7QUFFRCxJQUFNLGNBQWMsR0FBRyxVQUFDLFdBQW1CO0lBQ3pDLE9BQU8sV0FBVyxDQUFDLFdBQVcsQ0FBQyxDQUFDLElBQUksQ0FBQztRQUNuQyxJQUFJLEtBQUssR0FBRyxJQUFJLEVBQUUsQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDbkMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLE1BQU0sRUFBRSxHQUFHLE1BQU0sR0FBRyxDQUFDLENBQUMsQ0FBQztRQUM1QyxLQUFLLENBQUMsR0FBRyxDQUFDLFdBQVcsRUFBRSxLQUFLLENBQUMsQ0FBQztRQUM5QixLQUFLLENBQUMsR0FBRyxDQUFDLGFBQWEsRUFBRSxXQUFXLENBQUMsQ0FBQztRQUN0QyxPQUFPLEtBQUssQ0FBQyxJQUFJLEVBQUUsQ0FBQyxJQUFJLENBQUMsVUFBVSxHQUFpQjtZQUNsRCxPQUFPLEdBQUcsQ0FBQyxNQUFNLEVBQUUsQ0FBQztRQUN0QixDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFBO0FBQ0osQ0FBQyxDQUFBO0FBRUQsSUFBTSxjQUFjLEdBQUcsVUFBQyxFQUFVO0lBQ2hDLElBQU0sSUFBSSxHQUFHLEVBQUUsQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUMsT0FBTyxFQUFFLEVBQUUsQ0FBQyxDQUFDO0lBQ3RELElBQUksQ0FBQyxHQUFHLENBQUMsV0FBVyxFQUFFLElBQUksQ0FBQyxDQUFDO0lBQzVCLE9BQU8sSUFBSSxDQUFDLElBQUksRUFBRSxDQUFDLElBQUksQ0FBQyxVQUFDLEdBQWlCLElBQUssT0FBQSxHQUFHLENBQUMsTUFBTSxFQUFFLEVBQVosQ0FBWSxDQUFDLENBQUM7QUFDL0QsQ0FBQyxDQUFBO0FBQ0QsSUFBTSxjQUFjLEdBQUcsVUFBQyxFQUFVLEVBQUUsV0FBbUI7SUFDckQsT0FBTyxXQUFXLENBQUMsV0FBVyxDQUFDLENBQUMsSUFBSSxDQUFDO1FBQ25DLElBQU0sSUFBSSxHQUFHLEVBQUUsQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUMsT0FBTyxFQUFFLEVBQUUsQ0FBQyxDQUFDO1FBQ3RELElBQUksQ0FBQyxHQUFHLENBQUMsYUFBYSxFQUFFLFdBQVcsQ0FBQyxDQUFDO1FBQ3JDLE9BQU8sSUFBSSxDQUFDLElBQUksRUFBRSxDQUFDLElBQUksQ0FBQyxVQUFDLEdBQWlCLElBQUssT0FBQSxHQUFHLENBQUMsTUFBTSxFQUFFLEVBQVosQ0FBWSxDQUFDLENBQUM7SUFDL0QsQ0FBQyxDQUFDLENBQUE7QUFDSixDQUFDLENBQUE7QUFFRCxJQUFNLFlBQVksR0FBRztJQUNuQixJQUFNLFFBQVEsR0FBRyxJQUFJLEVBQUUsQ0FBQyxNQUFNLENBQUMsVUFBVSxDQUFDLENBQUE7SUFDMUMsUUFBUSxDQUFDLEdBQUcsQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLE1BQU0sRUFBRSxHQUFHLE1BQU0sR0FBRyxDQUFDLENBQUMsQ0FBQTtJQUM5QyxRQUFRLENBQUMsR0FBRyxDQUFDLFNBQVMsRUFBRSxLQUFLLENBQUMsQ0FBQTtJQUM5QixRQUFRLENBQUMsR0FBRyxDQUFDLGFBQWEsRUFBRSxFQUFFLENBQUMsQ0FBQTtJQUMvQixPQUFPLFFBQVEsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxJQUFJLENBQUMsVUFBQyxHQUFlLElBQUssT0FBQSxHQUFHLENBQUMsTUFBTSxFQUFFLEVBQVosQ0FBWSxDQUFDLENBQUE7QUFDaEUsQ0FBQyxDQUFBO0FBUUQsSUFBTSxZQUFZLEdBQUcsVUFBQyxLQUFnQjtJQUM1QixJQUFBLHlCQUFRLEVBQUUsK0JBQVcsRUFBRSx1QkFBTyxDQUFVO0lBQ2hELE9BQU8sV0FBVyxDQUFDLFdBQVcsQ0FBQyxDQUFDLElBQUksQ0FBQztRQUNuQyxJQUFNLE1BQU0sR0FBRyxFQUFFLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLFVBQVUsRUFBRSxRQUFRLENBQUMsQ0FBQztRQUNqRSxNQUFNLENBQUMsR0FBRyxDQUFDLGFBQWEsRUFBRSxXQUFXLENBQUMsQ0FBQztRQUN2QyxNQUFNLENBQUMsR0FBRyxDQUFDLFNBQVMsRUFBRSxPQUFPLENBQUMsQ0FBQTtRQUM5QixPQUFPLE1BQU0sQ0FBQyxJQUFJLEVBQUUsQ0FBQyxJQUFJLENBQUMsVUFBQyxHQUFlLElBQUssT0FBQSxHQUFHLENBQUMsTUFBTSxFQUFFLEVBQVosQ0FBWSxDQUFDLENBQUM7SUFDL0QsQ0FBQyxDQUFDLENBQUE7QUFDSixDQUFDLENBQUE7QUFFRCxPQUFPLEVBQUUsV0FBVyxFQUFFLGNBQWMsRUFBRSxjQUFjLEVBQUUsY0FBYyxFQUFFLFlBQVksRUFBRSxZQUFZLEVBQUUsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFRvZG9MaXN0SXRlbSwgVG9tYXRvSXRlbSB9IGZyb20gJy4uLy4uL3R5cGluZ3MvdHlwZXMvaW5kZXgnO1xyXG5pbXBvcnQge1xyXG4gIHNlY3VyZUNoZWNrXHJcbn0gZnJvbSAnLi9jbG91ZGZ1bmMnXHJcbmNvbnN0IHsgQVYgfSA9IGdldEFwcCgpLmdsb2JhbERhdGFcclxuY29uc3QgZ2V0VG9kb0xpc3QgPSAoKSA9PiB7XHJcbiAgcmV0dXJuIG5ldyBBVi5RdWVyeSgnVG9kb3MnKS5kZXNjZW5kaW5nKCdjcmVhdGVkQXQnKVxyXG4gICAgLmZpbmQoKVxyXG4gICAgLnRoZW4oKHRvZG9zOiBUb2RvTGlzdEl0ZW1bXSkgPT4ge1xyXG4gICAgICByZXR1cm4gdG9kb3MubWFwKCh0b2RvKSA9PiB0b2RvLnRvSlNPTigpKVxyXG4gICAgfSlcclxuICAgIC5jYXRjaChjb25zb2xlLmVycm9yKTtcclxufVxyXG5cclxuY29uc3QgY3JlYXRlVG9kb0l0ZW0gPSAoZGVzY3JpcHRpb246IHN0cmluZykgPT4ge1xyXG4gIHJldHVybiBzZWN1cmVDaGVjayhkZXNjcmlwdGlvbikudGhlbigoKSA9PiB7XHJcbiAgICB2YXIgdG9kb3MgPSBuZXcgQVYuT2JqZWN0KCdUb2RvcycpO1xyXG4gICAgdG9kb3Muc2V0KCdpZCcsIE1hdGgucmFuZG9tKCkgKiAxMDAwMDAgfCAwKTtcclxuICAgIHRvZG9zLnNldCgnY29tcGxldGVkJywgZmFsc2UpO1xyXG4gICAgdG9kb3Muc2V0KCdkZXNjcmlwdGlvbicsIGRlc2NyaXB0aW9uKTtcclxuICAgIHJldHVybiB0b2Rvcy5zYXZlKCkudGhlbihmdW5jdGlvbiAocmVzOiBUb2RvTGlzdEl0ZW0pIHtcclxuICAgICAgcmV0dXJuIHJlcy50b0pTT04oKTtcclxuICAgIH0pO1xyXG4gIH0pXHJcbn1cclxuXHJcbmNvbnN0IGRlbGV0ZVRvZG9JdGVtID0gKGlkOiBzdHJpbmcpID0+IHtcclxuICBjb25zdCB0b2RvID0gQVYuT2JqZWN0LmNyZWF0ZVdpdGhvdXREYXRhKCdUb2RvcycsIGlkKTtcclxuICB0b2RvLnNldCgnY29tcGxldGVkJywgdHJ1ZSk7XHJcbiAgcmV0dXJuIHRvZG8uc2F2ZSgpLnRoZW4oKHJlczogVG9kb0xpc3RJdGVtKSA9PiByZXMudG9KU09OKCkpO1xyXG59XHJcbmNvbnN0IHVwZGF0ZVRvZG9JdGVtID0gKGlkOiBzdHJpbmcsIGRlc2NyaXB0aW9uOiBzdHJpbmcpID0+IHtcclxuICByZXR1cm4gc2VjdXJlQ2hlY2soZGVzY3JpcHRpb24pLnRoZW4oKCkgPT4ge1xyXG4gICAgY29uc3QgdG9kbyA9IEFWLk9iamVjdC5jcmVhdGVXaXRob3V0RGF0YSgnVG9kb3MnLCBpZCk7XHJcbiAgICB0b2RvLnNldCgnZGVzY3JpcHRpb24nLCBkZXNjcmlwdGlvbik7XHJcbiAgICByZXR1cm4gdG9kby5zYXZlKCkudGhlbigocmVzOiBUb2RvTGlzdEl0ZW0pID0+IHJlcy50b0pTT04oKSk7XHJcbiAgfSlcclxufVxyXG5cclxuY29uc3QgY3JlYXRlVG9tYXRvID0gKCkgPT4ge1xyXG4gIGNvbnN0IHRvbWF0b2VzID0gbmV3IEFWLk9iamVjdCgnVG9tYXRvZXMnKVxyXG4gIHRvbWF0b2VzLnNldCgnaWQnLCBNYXRoLnJhbmRvbSgpICogMTAwMDAwIHwgMClcclxuICB0b21hdG9lcy5zZXQoJ2Fib3J0ZWQnLCBmYWxzZSlcclxuICB0b21hdG9lcy5zZXQoJ2Rlc2NyaXB0aW9uJywgJycpXHJcbiAgcmV0dXJuIHRvbWF0b2VzLnNhdmUoKS50aGVuKChyZXM6IFRvbWF0b0l0ZW0pID0+IHJlcy50b0pTT04oKSlcclxufVxyXG5cclxuaW50ZXJmYWNlIFBhcmFtVHlwZSB7XHJcbiAgb2JqZWN0SWQ6IHN0cmluZ1xyXG4gIGRlc2NyaXB0aW9uOiBzdHJpbmdcclxuICBhYm9ydGVkOiBib29sZWFuXHJcbn1cclxuXHJcbmNvbnN0IHVwZGF0ZVRvbWF0byA9IChwYXJhbTogUGFyYW1UeXBlKSA9PiB7XHJcbiAgY29uc3QgeyBvYmplY3RJZCwgZGVzY3JpcHRpb24sIGFib3J0ZWQgfSA9IHBhcmFtXHJcbiAgcmV0dXJuIHNlY3VyZUNoZWNrKGRlc2NyaXB0aW9uKS50aGVuKCgpID0+IHtcclxuICAgIGNvbnN0IHRvbWF0byA9IEFWLk9iamVjdC5jcmVhdGVXaXRob3V0RGF0YSgnVG9tYXRvZXMnLCBvYmplY3RJZCk7XHJcbiAgICB0b21hdG8uc2V0KCdkZXNjcmlwdGlvbicsIGRlc2NyaXB0aW9uKTtcclxuICAgIHRvbWF0by5zZXQoJ2Fib3J0ZWQnLCBhYm9ydGVkKVxyXG4gICAgcmV0dXJuIHRvbWF0by5zYXZlKCkudGhlbigocmVzOiBUb21hdG9JdGVtKSA9PiByZXMudG9KU09OKCkpO1xyXG4gIH0pXHJcbn1cclxuXHJcbmV4cG9ydCB7IGdldFRvZG9MaXN0LCBjcmVhdGVUb2RvSXRlbSwgZGVsZXRlVG9kb0l0ZW0sIHVwZGF0ZVRvZG9JdGVtLCBjcmVhdGVUb21hdG8sIHVwZGF0ZVRvbWF0byB9Il19